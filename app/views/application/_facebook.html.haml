#fb-root
:javascript
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '#{Facebook::APP_ID}', // App ID
      status     : true,                  // check login status
      cookie     : true,                  // enable cookies to allow the server to access the session
      oauth      : true,                  // enable OAuth 2.0
      frictionlessRequests : true,        // don't ask for permission to send apprequests to the same user twice 
      xfbml      : true                   // parse XFBML
    });

    // Additional initialization code here
  };

  // Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     d.getElementsByTagName('head')[0].appendChild(js);
   }(document));

  // Login function
  function fbLogin(callback) {
    FB.login(function(response) {
      // User authorizes app
      if (response.authResponse) {
        login(response);
      }
    }, { scope: '#{Facebook::SCOPE}' });

    function login(response) {
      if (callback) {
        callback(response);
      } else {
        $.ajax({
          url: "#{user_omniauth_callback_path(:facebook)}",
          success: function(data){
            var user = data
            if (user['id'] != null) {
              window.location.replace("#{root_url}");
            } else {
              var callback = function(){
                window.location = '/'
              }
              $(window.loginModal.el).modal('hide');
              window.loginModal.remove();
              window.loginModal = new Ananta.Views.Users.LoginRegisterModal({ callback: callback, user: user });
              window.loginModal.render();
            }
          }
        });
      }
    }
  }