-content_for :title do "Edit #{resource.username.possessive} profile" end

=content_for :javascripts do
	:javascript
		//
		window.bio = #{raw  @tags['bio'].to_json}
		window.seeking = #{raw  @tags['seeking'].to_json}
		window.offering = #{raw  @tags['offering'].to_json}
		//
		window.selected_bio = #{raw @selected_tags['bio'].to_json}
		window.selected_seeking = #{raw @selected_tags['seeking'].to_json}
		window.selected_offering = #{raw @selected_tags['offering'].to_json}
		//
		$(document).ready(function() {
			$('#profile_bio_tokens').tokenInput(window.bio, { theme : 'facebook', preventDuplicates: true, tokenLimit: 100, prePopulate: window.selected_bio, createTokenFromQuery: true } );
			$('#profile_seeking_tokens').tokenInput(window.seeking, { theme : 'facebook', preventDuplicates: true, tokenLimit: 100, prePopulate: window.selected_seeking, createTokenFromQuery: true } );
			$('#profile_offering_tokens').tokenInput(window.offering, { theme : 'facebook', preventDuplicates: true, tokenLimit: 100, prePopulate: window.selected_offering, createTokenFromQuery: true } );
		});
		//
		$(function () {
			// Initialize the jQuery File Upload widget:
			$("#profile_avatar").fileupload({
				namespace: "file_upload_profile_avatar",
				url: "/images.json",
				method: "PUT",
				autoUpload: true,
				maxFileSize: 5000000,
				acceptFileTypes: /(\.|\/)(gif|jpg|jpeg|png)$/i,
				formData: [
					{
						name: "imageable_type",
						value: "Profile"
					}, {
						name: "imageable_id",
						value: #{@profile.id}
					}, {
						name: "image_type",
						value: "avatar"
					}
				],
				add: function(e, data){
					$('.new-image').prepend('<img src="/assets/ajax-loader-white-bg.gif" class="loader" />')
					$('.new-image input').attr('disabled', 'disabled')
					data.submit();
				},
				done: function(e, data){
					$('.new-image img').remove()
					$('.new-image input').removeAttr('disabled')
					$('#profile_avatar > img').attr('src', data.result[0].medium_url)
				}
			});
		});

#edit_profile.user-edit
	.row-fluid
		.span3
			= render 'users/edit_nav', user: @profile.user, active: 'profile'
		.span9
			.boxed-group
				%h3
					Profile
				.inner
					= simple_form_for @profile, :html => {:class => "form-horizontal"} do |f|

						= f.input :name
						%br
						= f.input :avatar, hint: raw('avatar will change as soon as you choose a file or <br/> drag an image onto the screen') do
							#profile_avatar
								= image_tag(@profile.avatar.image.medium.url, :class => 'circle')
								.new-image
									= f.file_field :avatar, name: :image, id: :avatar_file
						%br
						= f.input :bio_tokens, label: "Bio", hint: 'Name a few notable events in your life.'
						%br
						= f.input :seeking_tokens, label: "Seeking", hint: 'What do you want?'
						%br
						= f.input :offering_tokens, label: "Offering", hint: 'What are you willing to give?'
						%br
						.form-actions
							= f.button :submit, :class => "btn-primary"
							= link_to 'Cancel', @profile, :class => "btn btn-danger"